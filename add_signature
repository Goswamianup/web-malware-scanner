#!/bin/bash

signatures_file="/home/anupgoswami/Desktop/webscan/signatures.json"

echo "Add a new signature to the database"
echo "1) Malware"
echo "2) Trojan"
echo "3) Spyware"
read -p "Select the category (1/2/3): " category

read -p "Enter the URL or pattern: " url

case $category in
    1)
        if ! jq -e --arg url "$url" '.malware[] | select(. == $url)' "$signatures_file" > /dev/null; then
            jq --arg url "$url" '.malware += [$url]' "$signatures_file" > tmp.json && mv tmp.json "$signatures_file"
            echo "Malware signature added."
        else
            echo "This malware signature already exists."
        fi
        ;;
    2)
        if ! jq -e --arg url "$url" '.trojans[] | select(. == $url)' "$signatures_file" > /dev/null; then
            jq --arg url "$url" '.trojans += [$url]' "$signatures_file" > tmp.json && mv tmp.json "$signatures_file"
            echo "Trojan signature added."
        else
            echo "This trojan signature already exists."
        fi
        ;;
    3)
        if ! jq -e --arg url "$url" '.spyware[] | select(. == $url)' "$signatures_file" > /dev/null; then
            jq --arg url "$url" '.spyware += [$url]' "$signatures_file" > tmp.json && mv tmp.json "$signatures_file"
            echo "Spyware signature added."
        else
            echo "This spyware signature already exists."
        fi
        ;;
    *)
        echo "Invalid category."
        ;;
esac
