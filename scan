#!/bin/bash

# Ensure all paths are relative to the current script's directory
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

source "$SCRIPT_DIR/parse_and_scan"
source "$SCRIPT_DIR/update_signatures"

read -p "Enter website URL (name, domain, or IP address): " url

signatures_file="$SCRIPT_DIR/signatures.json"

# Update the signatures with the latest CVE data before scanning
echo "Updating signatures..."
update_signatures "$signatures_file"

# Scan the website
echo "Scanning website..."
scan_website "$url" "$signatures_file"

echo "Scan and update completed."
